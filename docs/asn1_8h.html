<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LibNat20: include/nat20/asn1.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LibNat20
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_c352e5e5b8d6edb6c227a6d1a54acccd.html">nat20</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">asn1.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for asn1.h:</div>
<div class="dyncontent">
<div class="center"><img src="asn1_8h__incl.png" border="0" usemap="#ainclude_2nat20_2asn1_8h" alt=""/></div>
<map name="ainclude_2nat20_2asn1_8h" id="ainclude_2nat20_2asn1_8h">
<area shape="rect" title=" " alt="" coords="10,5,167,32"/>
<area shape="rect" title=" " alt="" coords="5,80,76,107"/>
<area shape="rect" title=" " alt="" coords="101,80,175,107"/>
</map>
</div>
</div>
<p><a href="asn1_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structn20__asn1__stream.html">n20_asn1_stream</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structn20__asn1__object__identifier.html">n20_asn1_object_identifier</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga4ad9b5f98e66522d93e4774b2e865076"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__classes.html#ga4ad9b5f98e66522d93e4774b2e865076">N20_ASN1_CLASS_UNIVERSAL</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ga4ad9b5f98e66522d93e4774b2e865076"><td class="mdescLeft">&#160;</td><td class="mdescRight">The universal class.  <a href="group__n20__asn1__classes.html#ga4ad9b5f98e66522d93e4774b2e865076">More...</a><br /></td></tr>
<tr class="separator:ga4ad9b5f98e66522d93e4774b2e865076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga30327d82985056cb039ba438baf0fe3b"><td class="memItemLeft" align="right" valign="top">
#define&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_CLASS_APPLICATION</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ga30327d82985056cb039ba438baf0fe3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf5b6a99ca59d6d9e09e20e270b41a43f"><td class="memItemLeft" align="right" valign="top">
#define&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_CLASS_CONTEXT_SPECIFIC</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:gaf5b6a99ca59d6d9e09e20e270b41a43f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga088e937625b5feb80f7494f6562c6ef5"><td class="memItemLeft" align="right" valign="top">
#define&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_CLASS_PRIVATE</b>&#160;&#160;&#160;3</td></tr>
<tr class="separator:ga088e937625b5feb80f7494f6562c6ef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2cafdce36001604820e72f4abfc7239b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__universal__tags.html#ga2cafdce36001604820e72f4abfc7239b">N20_ASN1_TAG_BOOLEAN</a>&#160;&#160;&#160;0x1</td></tr>
<tr class="memdesc:ga2cafdce36001604820e72f4abfc7239b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The boolean type.  <a href="group__n20__asn1__universal__tags.html#ga2cafdce36001604820e72f4abfc7239b">More...</a><br /></td></tr>
<tr class="separator:ga2cafdce36001604820e72f4abfc7239b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf063e0cb07c79855912c3a1089c52ee8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__universal__tags.html#gaf063e0cb07c79855912c3a1089c52ee8">N20_ASN1_TAG_INTEGER</a>&#160;&#160;&#160;0x2</td></tr>
<tr class="memdesc:gaf063e0cb07c79855912c3a1089c52ee8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The integer type.  <a href="group__n20__asn1__universal__tags.html#gaf063e0cb07c79855912c3a1089c52ee8">More...</a><br /></td></tr>
<tr class="separator:gaf063e0cb07c79855912c3a1089c52ee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadb079f2a6e6c0b7121b6e0b1b25c834e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__universal__tags.html#gadb079f2a6e6c0b7121b6e0b1b25c834e">N20_ASN1_TAG_BIT_STRING</a>&#160;&#160;&#160;0x3</td></tr>
<tr class="memdesc:gadb079f2a6e6c0b7121b6e0b1b25c834e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The bitstring type.  <a href="group__n20__asn1__universal__tags.html#gadb079f2a6e6c0b7121b6e0b1b25c834e">More...</a><br /></td></tr>
<tr class="separator:gadb079f2a6e6c0b7121b6e0b1b25c834e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacfa0b913d512baa3cb280689b5996026"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__universal__tags.html#gacfa0b913d512baa3cb280689b5996026">N20_ASN1_TAG_OCTET_STRING</a>&#160;&#160;&#160;0x4</td></tr>
<tr class="memdesc:gacfa0b913d512baa3cb280689b5996026"><td class="mdescLeft">&#160;</td><td class="mdescRight">The octet string type.  <a href="group__n20__asn1__universal__tags.html#gacfa0b913d512baa3cb280689b5996026">More...</a><br /></td></tr>
<tr class="separator:gacfa0b913d512baa3cb280689b5996026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab579d23a251c7695c8bfeb7bb99d936d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__universal__tags.html#gab579d23a251c7695c8bfeb7bb99d936d">N20_ASN1_TAG_NULL</a>&#160;&#160;&#160;0x5</td></tr>
<tr class="memdesc:gab579d23a251c7695c8bfeb7bb99d936d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The NULL type.  <a href="group__n20__asn1__universal__tags.html#gab579d23a251c7695c8bfeb7bb99d936d">More...</a><br /></td></tr>
<tr class="separator:gab579d23a251c7695c8bfeb7bb99d936d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga485eedfaa97a7c295b01a23812a9c6ca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__universal__tags.html#ga485eedfaa97a7c295b01a23812a9c6ca">N20_ASN1_TAG_N20_ASN1_OBJECT_IDENTIFIER</a>&#160;&#160;&#160;0x6</td></tr>
<tr class="memdesc:ga485eedfaa97a7c295b01a23812a9c6ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">The object identifier type.  <a href="group__n20__asn1__universal__tags.html#ga485eedfaa97a7c295b01a23812a9c6ca">More...</a><br /></td></tr>
<tr class="separator:ga485eedfaa97a7c295b01a23812a9c6ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3a643fc76df4511f19ff0617eca4cd39"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__universal__tags.html#ga3a643fc76df4511f19ff0617eca4cd39">N20_ASN1_TAG_SEQUENCE</a>&#160;&#160;&#160;0x10</td></tr>
<tr class="memdesc:ga3a643fc76df4511f19ff0617eca4cd39"><td class="mdescLeft">&#160;</td><td class="mdescRight">The sequence type.  <a href="group__n20__asn1__universal__tags.html#ga3a643fc76df4511f19ff0617eca4cd39">More...</a><br /></td></tr>
<tr class="separator:ga3a643fc76df4511f19ff0617eca4cd39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga49108fd34c2ddde329ca786641bfaa3b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__universal__tags.html#ga49108fd34c2ddde329ca786641bfaa3b">N20_ASN1_TAG_SET</a>&#160;&#160;&#160;0x11</td></tr>
<tr class="memdesc:ga49108fd34c2ddde329ca786641bfaa3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The set type.  <a href="group__n20__asn1__universal__tags.html#ga49108fd34c2ddde329ca786641bfaa3b">More...</a><br /></td></tr>
<tr class="separator:ga49108fd34c2ddde329ca786641bfaa3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9347fd2969173afac406eb57c78d0dd1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__universal__tags.html#ga9347fd2969173afac406eb57c78d0dd1">N20_ASN1_TAG_PRINTABLE_STRING</a>&#160;&#160;&#160;0x13</td></tr>
<tr class="memdesc:ga9347fd2969173afac406eb57c78d0dd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The printable string type.  <a href="group__n20__asn1__universal__tags.html#ga9347fd2969173afac406eb57c78d0dd1">More...</a><br /></td></tr>
<tr class="separator:ga9347fd2969173afac406eb57c78d0dd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga54371d10b495149b4a6d6dc711b97117"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__universal__tags.html#ga54371d10b495149b4a6d6dc711b97117">N20_ASN1_TAG_UTC_TIME</a>&#160;&#160;&#160;0x17</td></tr>
<tr class="memdesc:ga54371d10b495149b4a6d6dc711b97117"><td class="mdescLeft">&#160;</td><td class="mdescRight">The UTC time type.  <a href="group__n20__asn1__universal__tags.html#ga54371d10b495149b4a6d6dc711b97117">More...</a><br /></td></tr>
<tr class="separator:ga54371d10b495149b4a6d6dc711b97117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga98c888de45484c761eb0c679efff60ee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__n20__asn1__universal__tags.html#ga98c888de45484c761eb0c679efff60ee">N20_ASN1_TAG_GENERALIZED_TIME</a>&#160;&#160;&#160;0x18</td></tr>
<tr class="memdesc:ga98c888de45484c761eb0c679efff60ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">The GeneralizeTime type.  <a href="group__n20__asn1__universal__tags.html#ga98c888de45484c761eb0c679efff60ee">More...</a><br /></td></tr>
<tr class="separator:ga98c888de45484c761eb0c679efff60ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96509bb595cdce1f8e6e70112c32c2bb"><td class="memItemLeft" align="right" valign="top"><a id="a96509bb595cdce1f8e6e70112c32c2bb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_MAX_OID_ELEMENTS</b>&#160;&#160;&#160;7</td></tr>
<tr class="separator:a96509bb595cdce1f8e6e70112c32c2bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78bb9210ebc7f984fdb3b724a02b31d0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_OBJECT_ID</b>(...)</td></tr>
<tr class="separator:a78bb9210ebc7f984fdb3b724a02b31d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35cac7507f79253801cc1fb284da3930"><td class="memItemLeft" align="right" valign="top"><a id="a35cac7507f79253801cc1fb284da3930"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DEFINE_OID</b>(name, ...)&#160;&#160;&#160;    struct <a class="el" href="structn20__asn1__object__identifier.html">n20_asn1_object_identifier</a> name = N20_ASN1_OBJECT_ID(__VA_ARGS__)</td></tr>
<tr class="separator:a35cac7507f79253801cc1fb284da3930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a816e8a4ed1a7257287696b6f384310"><td class="memItemLeft" align="right" valign="top"><a id="a8a816e8a4ed1a7257287696b6f384310"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DECLARE_OID</b>(name)&#160;&#160;&#160;extern struct <a class="el" href="structn20__asn1__object__identifier.html">n20_asn1_object_identifier</a> name</td></tr>
<tr class="separator:a8a816e8a4ed1a7257287696b6f384310"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:accc516df0cec47d6f0a73c3ea97d7d79"><td class="memItemLeft" align="right" valign="top"><a id="accc516df0cec47d6f0a73c3ea97d7d79"></a>
typedef uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_class_t</b></td></tr>
<tr class="separator:accc516df0cec47d6f0a73c3ea97d7d79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a891c1fdb689940cbd03e52d2c9cafbaf"><td class="memItemLeft" align="right" valign="top"><a id="a891c1fdb689940cbd03e52d2c9cafbaf"></a>
typedef int&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_bool_t</b></td></tr>
<tr class="separator:a891c1fdb689940cbd03e52d2c9cafbaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeebe2dc56a137a2fdfa9786cf16c114f"><td class="memItemLeft" align="right" valign="top"><a id="aeebe2dc56a137a2fdfa9786cf16c114f"></a>
typedef struct <a class="el" href="structn20__asn1__stream.html">n20_asn1_stream</a>&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_stream_t</b></td></tr>
<tr class="separator:aeebe2dc56a137a2fdfa9786cf16c114f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee874479f6024dca2abebbb1752f8bdd"><td class="memItemLeft" align="right" valign="top"><a id="aee874479f6024dca2abebbb1752f8bdd"></a>
typedef struct <a class="el" href="structn20__asn1__object__identifier.html">n20_asn1_object_identifier</a>&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_object_identifier_t</b></td></tr>
<tr class="separator:aee874479f6024dca2abebbb1752f8bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d61cd4943c2b6a9fedcb83a8d4df285"><td class="memItemLeft" align="right" valign="top"><a id="a9d61cd4943c2b6a9fedcb83a8d4df285"></a>
typedef void()&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_content_cb_t</b>(<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *, void *)</td></tr>
<tr class="separator:a9d61cd4943c2b6a9fedcb83a8d4df285"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6c174ae8d5195ef9ce77d69330e65f32"><td class="memItemLeft" align="right" valign="top"><a id="a6c174ae8d5195ef9ce77d69330e65f32"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_stream_init</b> (struct <a class="el" href="structn20__asn1__stream.html">n20_asn1_stream</a> *s, uint8_t *buffer, size_t buffer_size)</td></tr>
<tr class="separator:a6c174ae8d5195ef9ce77d69330e65f32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59f4a298a5ed2bcf6722109019aa24dd"><td class="memItemLeft" align="right" valign="top">n20_asn1_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asn1_8h.html#a59f4a298a5ed2bcf6722109019aa24dd">n20_asn1_stream_is_good</a> (struct <a class="el" href="structn20__asn1__stream.html">n20_asn1_stream</a> const *s)</td></tr>
<tr class="memdesc:a59f4a298a5ed2bcf6722109019aa24dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the stream is good.  <a href="asn1_8h.html#a59f4a298a5ed2bcf6722109019aa24dd">More...</a><br /></td></tr>
<tr class="separator:a59f4a298a5ed2bcf6722109019aa24dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbcdc81a156ada177d566f5fd1973058"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asn1_8h.html#acbcdc81a156ada177d566f5fd1973058">n20_asn1_stream_data_written</a> (struct <a class="el" href="structn20__asn1__stream.html">n20_asn1_stream</a> const *s)</td></tr>
<tr class="memdesc:acbcdc81a156ada177d566f5fd1973058"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query the number of bytes written to the stream.  <a href="asn1_8h.html#acbcdc81a156ada177d566f5fd1973058">More...</a><br /></td></tr>
<tr class="separator:acbcdc81a156ada177d566f5fd1973058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaf778d6b03361f916bdc052de86c9b7"><td class="memItemLeft" align="right" valign="top">uint8_t const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asn1_8h.html#aeaf778d6b03361f916bdc052de86c9b7">n20_asn1_stream_data</a> (struct <a class="el" href="structn20__asn1__stream.html">n20_asn1_stream</a> const *s)</td></tr>
<tr class="memdesc:aeaf778d6b03361f916bdc052de86c9b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Points to the current stream position.  <a href="asn1_8h.html#aeaf778d6b03361f916bdc052de86c9b7">More...</a><br /></td></tr>
<tr class="separator:aeaf778d6b03361f916bdc052de86c9b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b7295673d4e08d7b1f845b716cdcbf4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asn1_8h.html#a2b7295673d4e08d7b1f845b716cdcbf4">n20_asn1_stream_prepend</a> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, uint8_t const *src, size_t src_len)</td></tr>
<tr class="memdesc:a2b7295673d4e08d7b1f845b716cdcbf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a buffer to the front of the stream buffer.  <a href="asn1_8h.html#a2b7295673d4e08d7b1f845b716cdcbf4">More...</a><br /></td></tr>
<tr class="separator:a2b7295673d4e08d7b1f845b716cdcbf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a447a18036995e37953eba63a20bae0d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asn1_8h.html#a447a18036995e37953eba63a20bae0d4">n20_asn1_stream_put</a> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, uint8_t c)</td></tr>
<tr class="memdesc:a447a18036995e37953eba63a20bae0d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience function to write a single byte to the stream.  <a href="asn1_8h.html#a447a18036995e37953eba63a20bae0d4">More...</a><br /></td></tr>
<tr class="separator:a447a18036995e37953eba63a20bae0d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1688390fc70db948f1a110cc972cd3fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asn1_8h.html#a1688390fc70db948f1a110cc972cd3fd">n20_asn1_base128_int</a> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, uint64_t n)</td></tr>
<tr class="memdesc:a1688390fc70db948f1a110cc972cd3fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a base 128 integer to the given stream.  <a href="asn1_8h.html#a1688390fc70db948f1a110cc972cd3fd">More...</a><br /></td></tr>
<tr class="separator:a1688390fc70db948f1a110cc972cd3fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bf49865d4b0ea11589306be70986015"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asn1_8h.html#a1bf49865d4b0ea11589306be70986015">n20_asn1_header</a> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, n20_asn1_class_t class_, n20_asn1_bool_t constructed, uint32_t tag, size_t len)</td></tr>
<tr class="memdesc:a1bf49865d4b0ea11589306be70986015"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write an ASN.1 header to the given stream.  <a href="asn1_8h.html#a1bf49865d4b0ea11589306be70986015">More...</a><br /></td></tr>
<tr class="separator:a1bf49865d4b0ea11589306be70986015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a202106bd3caa153d4e3fd4d60d46b4f0"><td class="memItemLeft" align="right" valign="top"><a id="a202106bd3caa153d4e3fd4d60d46b4f0"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DECLARE_OID</b> (OID_RSA_ENCRYPTION)</td></tr>
<tr class="separator:a202106bd3caa153d4e3fd4d60d46b4f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70a9d78851fa5c08caf0cd10413b1b69"><td class="memItemLeft" align="right" valign="top"><a id="a70a9d78851fa5c08caf0cd10413b1b69"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DECLARE_OID</b> (OID_SHA256_WITH_RSA_ENC)</td></tr>
<tr class="separator:a70a9d78851fa5c08caf0cd10413b1b69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad484270871a0364c2391915545d77faf"><td class="memItemLeft" align="right" valign="top"><a id="ad484270871a0364c2391915545d77faf"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DECLARE_OID</b> (OID_LOCALITY_NAME)</td></tr>
<tr class="separator:ad484270871a0364c2391915545d77faf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04489d46049093154947c9dfcfe01b9d"><td class="memItemLeft" align="right" valign="top"><a id="a04489d46049093154947c9dfcfe01b9d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DECLARE_OID</b> (OID_COUNTRY_NAME)</td></tr>
<tr class="separator:a04489d46049093154947c9dfcfe01b9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4552a47b1d1e45a0980edf37117b323"><td class="memItemLeft" align="right" valign="top"><a id="ad4552a47b1d1e45a0980edf37117b323"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DECLARE_OID</b> (OID_STATE_OR_PROVINCE_NAME)</td></tr>
<tr class="separator:ad4552a47b1d1e45a0980edf37117b323"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ade38c88d08dee1cae3caf9ed586fef"><td class="memItemLeft" align="right" valign="top"><a id="a1ade38c88d08dee1cae3caf9ed586fef"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DECLARE_OID</b> (OID_ORGANIZATION_NAME)</td></tr>
<tr class="separator:a1ade38c88d08dee1cae3caf9ed586fef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95a56b10cc783cf0ffa77b451aa47f22"><td class="memItemLeft" align="right" valign="top"><a id="a95a56b10cc783cf0ffa77b451aa47f22"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DECLARE_OID</b> (OID_ORGANIZATION_UNIT_NAME)</td></tr>
<tr class="separator:a95a56b10cc783cf0ffa77b451aa47f22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a550ea6127dbe60eff0e6cc6a51250e"><td class="memItemLeft" align="right" valign="top"><a id="a9a550ea6127dbe60eff0e6cc6a51250e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DECLARE_OID</b> (OID_COMMON_NAME)</td></tr>
<tr class="separator:a9a550ea6127dbe60eff0e6cc6a51250e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac20fbcb28d2a1939087642c3d044338e"><td class="memItemLeft" align="right" valign="top"><a id="ac20fbcb28d2a1939087642c3d044338e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DECLARE_OID</b> (OID_BASIC_CONSTRAINTS)</td></tr>
<tr class="separator:ac20fbcb28d2a1939087642c3d044338e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51c935234426cf09dbef16010f9412f3"><td class="memItemLeft" align="right" valign="top"><a id="a51c935234426cf09dbef16010f9412f3"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>N20_ASN1_DECLARE_OID</b> (OID_KEY_USAGE)</td></tr>
<tr class="separator:a51c935234426cf09dbef16010f9412f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06907e5a431f730568691765a3252b29"><td class="memItemLeft" align="right" valign="top"><a id="a06907e5a431f730568691765a3252b29"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_null</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *const s)</td></tr>
<tr class="separator:a06907e5a431f730568691765a3252b29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51933ba3db035dfaf79696dd6577c5b9"><td class="memItemLeft" align="right" valign="top"><a id="a51933ba3db035dfaf79696dd6577c5b9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_object_identifier</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, struct <a class="el" href="structn20__asn1__object__identifier.html">n20_asn1_object_identifier</a> const *oid)</td></tr>
<tr class="separator:a51933ba3db035dfaf79696dd6577c5b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac4f5c04a8a19fe52d78ad4dbbd181fb"><td class="memItemLeft" align="right" valign="top"><a id="aac4f5c04a8a19fe52d78ad4dbbd181fb"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_integer_internal</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, uint8_t const *n, size_t len, n20_asn1_bool_t little_endian, n20_asn1_bool_t unsigned_)</td></tr>
<tr class="separator:aac4f5c04a8a19fe52d78ad4dbbd181fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7453075ff29128aace82d94e78645054"><td class="memItemLeft" align="right" valign="top"><a id="a7453075ff29128aace82d94e78645054"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_integer</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, uint8_t const *n, size_t len, n20_asn1_bool_t little_endian, n20_asn1_bool_t unsigned_)</td></tr>
<tr class="separator:a7453075ff29128aace82d94e78645054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32994bd3b0d5152745c629facaedd957"><td class="memItemLeft" align="right" valign="top"><a id="a32994bd3b0d5152745c629facaedd957"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_uint64</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, uint64_t n)</td></tr>
<tr class="separator:a32994bd3b0d5152745c629facaedd957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f2e9832438aea0e79a11e69a74ec9ac"><td class="memItemLeft" align="right" valign="top"><a id="a6f2e9832438aea0e79a11e69a74ec9ac"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_int64</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, int64_t n)</td></tr>
<tr class="separator:a6f2e9832438aea0e79a11e69a74ec9ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf8e8efe9b8428dcfab088061d76bf9e"><td class="memItemLeft" align="right" valign="top"><a id="abf8e8efe9b8428dcfab088061d76bf9e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_bitstring</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, uint8_t const *b, size_t bits)</td></tr>
<tr class="separator:abf8e8efe9b8428dcfab088061d76bf9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08fa3dfd77b40d44b80349a52654c9b6"><td class="memItemLeft" align="right" valign="top"><a id="a08fa3dfd77b40d44b80349a52654c9b6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_octetstring</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, uint8_t const *str, size_t len)</td></tr>
<tr class="separator:a08fa3dfd77b40d44b80349a52654c9b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2142a262b9f953145724d74fe0dd46e"><td class="memItemLeft" align="right" valign="top"><a id="af2142a262b9f953145724d74fe0dd46e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_printablestring</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, char const *str)</td></tr>
<tr class="separator:af2142a262b9f953145724d74fe0dd46e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7695656716f745ca7358a55c7526f6a2"><td class="memItemLeft" align="right" valign="top"><a id="a7695656716f745ca7358a55c7526f6a2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_generalized_time</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, char const *time_str)</td></tr>
<tr class="separator:a7695656716f745ca7358a55c7526f6a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a246a1865b159197ecc2d4620fb98fdfc"><td class="memItemLeft" align="right" valign="top"><a id="a246a1865b159197ecc2d4620fb98fdfc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_header_with_content</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, n20_asn1_class_t class_, n20_asn1_bool_t constructed, uint32_t tag, n20_asn1_content_cb_t content_cb, void *cb_context)</td></tr>
<tr class="separator:a246a1865b159197ecc2d4620fb98fdfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5625bd496e45a4fb37bc0abf2ed0a710"><td class="memItemLeft" align="right" valign="top"><a id="a5625bd496e45a4fb37bc0abf2ed0a710"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_sequence</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, n20_asn1_content_cb_t content_cb, void *cb_context)</td></tr>
<tr class="separator:a5625bd496e45a4fb37bc0abf2ed0a710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7167d3e5f3c46382686870a07ccc3e9c"><td class="memItemLeft" align="right" valign="top"><a id="a7167d3e5f3c46382686870a07ccc3e9c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>n20_asn1_boolean</b> (<a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *s, n20_asn1_bool_t v)</td></tr>
<tr class="separator:a7167d3e5f3c46382686870a07ccc3e9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a78bb9210ebc7f984fdb3b724a02b31d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78bb9210ebc7f984fdb3b724a02b31d0">&#9670;&nbsp;</a></span>N20_ASN1_OBJECT_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define N20_ASN1_OBJECT_ID</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                                                       \</div>
<div class="line">        .elem_count = <span class="keyword">sizeof</span>((uint32_t[]){__VA_ARGS__}) / <span class="keyword">sizeof</span>(uint32_t), \</div>
<div class="line">        .elements = {__VA_ARGS__},                                          \</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1688390fc70db948f1a110cc972cd3fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1688390fc70db948f1a110cc972cd3fd">&#9670;&nbsp;</a></span>n20_asn1_base128_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void n20_asn1_base128_int </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a base 128 integer to the given stream. </p>
<p>A base 128 integer is always positive. The encoding uses the msb of every byte to indicate whether more bytes follow. The final byte has the msb cleared; it holds the 7 least significant bits of the integer. This function follows distinguished encoding rules (DER) in that it uses the least number of bytes to encode the given integer.</p>
<p>This integer encoding is used for encoding long form tags in the ASN1.1 header and also in the encoding of object identifiers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The stream that is to be updated. </td></tr>
    <tr><td class="paramname">n</td><td>The integer to be written. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1bf49865d4b0ea11589306be70986015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bf49865d4b0ea11589306be70986015">&#9670;&nbsp;</a></span>n20_asn1_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void n20_asn1_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">n20_asn1_class_t&#160;</td>
          <td class="paramname"><em>class_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">n20_asn1_bool_t&#160;</td>
          <td class="paramname"><em>constructed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write an ASN.1 header to the given stream. </p>
<p>The first byte of the ASN.1 header consists of the following bits form most to least significant</p>
<p><code>ccCttttt</code></p>
<p>Where:</p><ul>
<li><code>c</code> denotes the ASN.1 class (see <a class="el" href="group__n20__asn1__classes.html">ASN.1 Classes</a>)</li>
<li><code>C</code> denotes whether the type is constructed (<code>1</code>) or primitive (<code>0</code>)</li>
<li><code>t</code> holds the tag (see <a class="el" href="group__n20__asn1__universal__tags.html">ASN.1 Universal Tags</a>). If the tag is is greater 30, all <code>t</code> bits are set to <code>1</code> and the tag is encoded in subsequent bytes using base 128 encoding (see <a class="el" href="asn1_8h.html#a1688390fc70db948f1a110cc972cd3fd">n20_asn1_base128_int</a>).</li>
</ul>
<p>The header and conditional tag bytes is followed by the length field. If the length of the structure is less then or equal to 127, the length is encoded in a single byte as a positive integer with the msb set to <code>0</code>. If the lengths is grater than 127, the first byte of the length field indicates the size of the length field in bytes in the lower seven bits with the msb set to <code>1</code>. Subsequent bytes hold the length in big endian order. DER requires that the least number of bytes is used to represent the length.</p>
<h2><a class="anchor" id="autotoc_md0"></a>
Example</h2>
<p>Remember that the stream is written in reverse. This means that a header is written after the content of the structure. This makes it very easy to determine the length of the structure and the length of the length field. A typical usage pattern of this function is as follows:</p>
<div class="fragment"><div class="line"><span class="keywordtype">size_t</span> mark = <a class="code" href="asn1_8h.html#acbcdc81a156ada177d566f5fd1973058">n20_asn1_stream_data_written</a>(s);</div>
<div class="line"><span class="comment">// Write structure content here.</span></div>
<div class="line"><a class="code" href="asn1_8h.html#a1bf49865d4b0ea11589306be70986015">n20_asn1_header</a>(s,</div>
<div class="line">            <a class="code" href="group__n20__asn1__classes.html#ga4ad9b5f98e66522d93e4774b2e865076">N20_ASN1_CLASS_UNIVERSAL</a>,</div>
<div class="line">            1, <span class="comment">// constructed</span></div>
<div class="line">            <a class="code" href="group__n20__asn1__universal__tags.html#ga3a643fc76df4511f19ff0617eca4cd39">N20_ASN1_TAG_SEQUENCE</a>,</div>
<div class="line">            <a class="code" href="asn1_8h.html#acbcdc81a156ada177d566f5fd1973058">n20_asn1_stream_data_written</a>(s) - mark);</div>
<div class="ttc" id="aasn1_8h_html_a1bf49865d4b0ea11589306be70986015"><div class="ttname"><a href="asn1_8h.html#a1bf49865d4b0ea11589306be70986015">n20_asn1_header</a></div><div class="ttdeci">void n20_asn1_header(n20_asn1_stream_t *s, n20_asn1_class_t class_, n20_asn1_bool_t constructed, uint32_t tag, size_t len)</div><div class="ttdoc">Write an ASN.1 header to the given stream.</div></div>
<div class="ttc" id="aasn1_8h_html_acbcdc81a156ada177d566f5fd1973058"><div class="ttname"><a href="asn1_8h.html#acbcdc81a156ada177d566f5fd1973058">n20_asn1_stream_data_written</a></div><div class="ttdeci">size_t n20_asn1_stream_data_written(struct n20_asn1_stream const *s)</div><div class="ttdoc">Query the number of bytes written to the stream.</div></div>
<div class="ttc" id="agroup__n20__asn1__classes_html_ga4ad9b5f98e66522d93e4774b2e865076"><div class="ttname"><a href="group__n20__asn1__classes.html#ga4ad9b5f98e66522d93e4774b2e865076">N20_ASN1_CLASS_UNIVERSAL</a></div><div class="ttdeci">#define N20_ASN1_CLASS_UNIVERSAL</div><div class="ttdoc">The universal class.</div><div class="ttdef"><b>Definition:</b> asn1.h:38</div></div>
<div class="ttc" id="agroup__n20__asn1__universal__tags_html_ga3a643fc76df4511f19ff0617eca4cd39"><div class="ttname"><a href="group__n20__asn1__universal__tags.html#ga3a643fc76df4511f19ff0617eca4cd39">N20_ASN1_TAG_SEQUENCE</a></div><div class="ttdeci">#define N20_ASN1_TAG_SEQUENCE</div><div class="ttdoc">The sequence type.</div><div class="ttdef"><b>Definition:</b> asn1.h:125</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The stream that is to be updated. </td></tr>
    <tr><td class="paramname">class_</td><td>One of <a class="el" href="group__n20__asn1__classes.html">ASN.1 Classes</a>. </td></tr>
    <tr><td class="paramname">constructed</td><td>Non zero if the structure is constructed, zero for primitive. </td></tr>
    <tr><td class="paramname">tag</td><td>The tag. </td></tr>
    <tr><td class="paramname">len</td><td>The length of the content of the structure started by this header. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aeaf778d6b03361f916bdc052de86c9b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaf778d6b03361f916bdc052de86c9b7">&#9670;&nbsp;</a></span>n20_asn1_stream_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t const* n20_asn1_stream_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structn20__asn1__stream.html">n20_asn1_stream</a> const *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Points to the current stream position. </p>
<p>The stream is always written from the end of the buffer. This means that the returned pointer points always to the beginning of the written section. If no data has been written this points past the end of the buffer.</p>
<p>IMPORTANT it is only safe to dereference the returned pointer if <a class="el" href="asn1_8h.html#a59f4a298a5ed2bcf6722109019aa24dd">n20_asn1_stream_is_good</a> returns a non zero value. Also the access must be within the range [p, p + <a class="el" href="asn1_8h.html#acbcdc81a156ada177d566f5fd1973058">n20_asn1_stream_data_written</a>) where p is the </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>the pointer to the stream that is to be queried. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the beginning of the written buffer. </dd></dl>

</div>
</div>
<a id="acbcdc81a156ada177d566f5fd1973058"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbcdc81a156ada177d566f5fd1973058">&#9670;&nbsp;</a></span>n20_asn1_stream_data_written()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t n20_asn1_stream_data_written </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structn20__asn1__stream.html">n20_asn1_stream</a> const *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Query the number of bytes written to the stream. </p>
<p>This function always returns the correct amount of data that was written to the stream even if the stream is bad. If the stream was bad it means that the stream ran out of buffer. In this case the return value of this function can be used as a hint to allocate a new buffer and initialize a new stream that will fit the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>the pointer to the stream that is to be queried. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size_t number of bytes written to the stream. </dd></dl>

</div>
</div>
<a id="a59f4a298a5ed2bcf6722109019aa24dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59f4a298a5ed2bcf6722109019aa24dd">&#9670;&nbsp;</a></span>n20_asn1_stream_is_good()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">n20_asn1_bool_t n20_asn1_stream_is_good </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structn20__asn1__stream.html">n20_asn1_stream</a> const *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the stream is good. </p>
<p>The stream is considered good if all bytes written to it where stored in the underlying stream buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>the pointer to the stream that is to be queried. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>n20_asn1_bool_t non zero if the stream is good. </dd></dl>

</div>
</div>
<a id="a2b7295673d4e08d7b1f845b716cdcbf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b7295673d4e08d7b1f845b716cdcbf4">&#9670;&nbsp;</a></span>n20_asn1_stream_prepend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void n20_asn1_stream_prepend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t const *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>src_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a buffer to the front of the stream buffer. </p>
<p>The asn1 stream is always written in revers. This means that prepending is the only way to write to the stream buffer. The buffer's write position is moved by <code>-src_len</code> unconditionally. If the stream is good and the new position points inside of the underlying buffer, the entire source buffer src is copied into the stream buffer. Otherwise, nothing is copied and the stream is marked as bad. A bad stream can still be written to, but it will only record the number of bytes written without storing any data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The stream that is to be updated. </td></tr>
    <tr><td class="paramname">src</td><td>The source buffer that is to be written to the stream. </td></tr>
    <tr><td class="paramname">src_len</td><td>The size of the source buffer in bytes. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a447a18036995e37953eba63a20bae0d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a447a18036995e37953eba63a20bae0d4">&#9670;&nbsp;</a></span>n20_asn1_stream_put()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void n20_asn1_stream_put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structn20__asn1__stream.html">n20_asn1_stream_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convenience function to write a single byte to the stream. </p>
<p>This convenience function prepends a single byte to the stream. It is useful for writing literals that are not already stored in a memory address that can be referred to with a pointer.</p>
<p>The function call </p><div class="fragment"><div class="line"><a class="code" href="asn1_8h.html#a447a18036995e37953eba63a20bae0d4">n20_asn1_stream_put</a>(s, 3)</div>
<div class="ttc" id="aasn1_8h_html_a447a18036995e37953eba63a20bae0d4"><div class="ttname"><a href="asn1_8h.html#a447a18036995e37953eba63a20bae0d4">n20_asn1_stream_put</a></div><div class="ttdeci">void n20_asn1_stream_put(n20_asn1_stream_t *s, uint8_t c)</div><div class="ttdoc">Convenience function to write a single byte to the stream.</div></div>
</div><!-- fragment --><p> is equivalent to </p><div class="fragment"><div class="line">uint8_t c = 3</div>
<div class="line"><a class="code" href="asn1_8h.html#a2b7295673d4e08d7b1f845b716cdcbf4">n20_asn1_stream_prepend</a>(s, &amp;c, 1)</div>
<div class="ttc" id="aasn1_8h_html_a2b7295673d4e08d7b1f845b716cdcbf4"><div class="ttname"><a href="asn1_8h.html#a2b7295673d4e08d7b1f845b716cdcbf4">n20_asn1_stream_prepend</a></div><div class="ttdeci">void n20_asn1_stream_prepend(n20_asn1_stream_t *s, uint8_t const *src, size_t src_len)</div><div class="ttdoc">Write a buffer to the front of the stream buffer.</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The stream that is to be updated. </td></tr>
    <tr><td class="paramname">c</td><td>The byte that is to be written. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="asn1_8h.html#a2b7295673d4e08d7b1f845b716cdcbf4" title="Write a buffer to the front of the stream buffer.">n20_asn1_stream_prepend</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
